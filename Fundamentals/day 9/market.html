<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
    let products = [
    {id: 1, name: "apel", price: 10000, stock: 10},
    {id: 2, name: "jeruk", price: 15000, stock: 15},
    {id: 3, name: "mangga", price: 20000, stock: 20},
    ] 
    let cart = [];
let total = 0;
let display = "Purwadhika Mart \n";
//tampilan menu
for(let i = 0; i < products.length; i++){
    display += `${i+1}. ${products[i].name} ${products[i].price} (${products[i].stock}) \n`;
}
    //input nomor barang
let input = prompt(display + "masukkan nomor barang yang ingin dibeli:");

//input jumlah barang
let quantity = prompt("masukkan jumlah barang yang ingin dibeli:");
let index = input - 1;
let product = products[index];
let subtotal = product.price * quantity;
let stock = product.stock - quantity;
do{
    //pembelian barang
if(input > 0 && input <= products.length){
    if(quantity <= product.stock){
        alert("Transaksi Berhasil");
        cart.push({product, quantity, subtotal});
        total += subtotal;
        product.stock = stock;
        //tampilkan cart
        let cartDisplay = "Keranjang Belanja \n";
        for(let i = 0; i < cart.length; i++){
            cartDisplay += `${i+1}. ${cart[i].product.name} ${cart[i].quantity} x ${cart[i].subtotal.toLocaleString()} \n`;
        }
        cartDisplay += `Total: ${total.toLocaleString()}`;
        alert(cartDisplay);
        //if user mau beli lagi, kembali ke menu. jika tidak, masuk ke pembayaran
        let lagi = confirm("Mau Beli Lagi?");
        if(lagi){
            input = prompt(display + "masukkan nomor barang yang ingin dibeli:");
            quantity = prompt("masukkan jumlah barang yang ingin dibeli:");
            index = input - 1;
            product = products[index];
            subtotal = product.price * quantity;
            stock = product.stock - quantity;
        }else{
            //pembayaran
            let bayar = prompt("Total Belanja: " + total.toLocaleString() + "\n" + "Masukkan Jumlah Uang:");
            let kembalian = bayar - total;
            alert("Kembalian: " + kembalian.toLocaleString());
            alert("Terima Kasih");
            break;
        }
    }else{
        alert("Barang yang anda pilih tidak tersedia");
    }
}else{
    alert("Barang yang anda pilih tidak tersedia");
}
} while( input > 0 && input <= products.length);





    //flow
    //1. tampilkan daftar barang
    //2. input nomor barang
    //3. input jumlah barang
    //4. tampilkan total belanjaan
    //5. konfirmasi transaksi
    //6. jika ya, masukkan ke cart
    //7. jika tidak, cart kosong
    //8. tampilkan cart
    //9. masukkan jumlah uang yang dibayarkan
    //10. tampilkan kembalian
    //11. tampilkan transaksi berhasil
    //12. transaksi selesai

    </script>
</body>
</html>